[task_sequence]
name = "sinusoid"

[evaluation]
metrics = ["accuracy"]

[plot]
n_classes = 2
x1_max = 3.0
x1_min = -0.5
x2_max = 1.5
x2_min = -1.0

[model]
name = "FCNN3"

[model.args]
dense0 = 16
dense1 = 16
dense2 = 1

[model.spec]
nll = "SIGMOID_CROSS_ENTROPY"
in_shape = [ 2 ]
out_shape = [ 1 ]

[[trainers]]
id = "joint"
name = "Joint"
label = "Joint training"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
lr_schedule = "constant"
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.hparams.predict]

[[trainers]]
id = "finetuning"
name = "Finetuning"
label = "Finetuning"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
lr_schedule = "constant"
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.hparams.predict]

[[trainers]]
id = "gvcl"
name = "GVCL"
label = "G VCL"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
lr_schedule = "constant"
mc = true
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
sample_size = 100
seed = 1337

[[trainers]]
id = "tvcl"
name = "TVCL"
label = "t VCL"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
df = 8
lr_schedule = "constant"
n_epochs = 100
invscale = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
df = 8
sample_size = 100
seed = 1337

[[trainers]]
id = "gmvcl"
name = "GMVCL"
label = "GM VCL"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
lr_schedule = "constant"
mc = true
n_comp = 3
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 3
sample_size = 100
seed = 1337

[[trainers]]
id = "gsfsvi"
name = "PriorExactGSFSVI"
label = "G S-FSVI"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
beta = 1.0
coreset_batch_size_per_task = 16
coreset_prob = 0.5
coreset_size_per_task = 32
lr_schedule = "constant"
mc = true
noise_init = true
noise_maxval = 4.0
noise_minval = -4.0
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
sample_size = 100
seed = 1337

[[trainers]]
id = "tsfsvi"
name = "PriorExactTSFSVI"
label = "t S-FSVI"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
beta = 1.0
coreset_batch_size_per_task = 16
coreset_prob = 0.5
coreset_size_per_task = 32
df = 8
lr_schedule = "constant"
noise_init = true
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0]
n_epochs = 100
invscale = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
df = 8
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi"
name = "PriorExactGMSFSVI"
label = "GM S-FSVI"

[trainers.hparams.train]
base_lr = 0.001
batch_size = 64
beta = 1.0
coreset_batch_size_per_task = 16
coreset_prob = 0.5
coreset_size_per_task = 32
lr_schedule = "constant"
mc = true
noise_init = true
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0]
n_comp = 3
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 3
sample_size = 100
seed = 1337
