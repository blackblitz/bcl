[task_sequence]
name = "split_iris_2"

[evaluation]
metrics = ["accuracy"]

[plot]
n_classes = 3
x1_max = 7.0
x1_min = 0.0
x2_max = 3.0
x2_min = 0.0

[model]
name = "FCNN2"

[model.args]
dense0 = 4
dense1 = 3

[model.spec]
nll = "SOFTMAX_CROSS_ENTROPY"
in_shape = [ 2 ]
out_shape = [ 3 ]

[[trainers]]
id = "joint"
name = "Joint"
label = "Joint training"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "finetuning"
name = "Finetuning"
label = "Fine-tuning"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "ewc"
name = "ElasticWeightConsolidation"
label = "EWC"

[trainers.immutables.train]
batch_size = 8
lambda = 1.0
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "si"
name = "SynapticIntelligence"
label="SI"

[trainers.immutables.train]
batch_size = 8
lambda = 1.0
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337
xi = 1.0

[trainers.immutables.predict]

[[trainers]]
id = "aqc"
name = "AutodiffQuadraticConsolidation"
label = "AQC"

[trainers.immutables.train]
batch_size = 8
lambda = 1.0
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "nc"
name = "NeuralConsolidation"
label = "NC"

[trainers.immutables.train]
batch_size = 8
con_dense0 = 256
con_dense1 = 256
con_lr = 0.01
con_n_steps = 1000
con_precision = 0.1
con_radius = 10.0
con_sample_size = 64
lr = 0.01
n_epochs = 100
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "gvcl"
name = "GVCL"
label = "G-VCL"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
n_epochs = 100
precision = 0.1
sample_size = 10
seed = 1337

[trainers.immutables.predict]
sample_size = 100
seed = 1337

[[trainers]]
id = "gmvcl"
name = "GMVCL"
label = "GM-VCL"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
mc_kldiv = false
n_comp = 3
n_epochs = 100
precision = 0.1
sample_size = 10
seed = 1337

[trainers.immutables.predict]
n_comp = 3
sample_size = 100
seed = 1337

[[trainers]]
id = "gsfsvi"
name = "SimpleGSFSVI"
label = "G-S-FSVI"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
noise_batch_size = 8
noise_maxval = [ 6.7, 2.4 ]
noise_minval = [ 1.0, 0.1 ]
n_epochs = 100
precision = 0.1
sample_size = 10
seed = 1337

[trainers.immutables.predict]
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi"
name = "SimpleGMSFSVI"
label = "GM-S-FSVI"

[trainers.immutables.train]
batch_size = 8
lr = 0.01
mc_kldiv = false
noise_batch_size = 8
noise_maxval = [ 6.7, 2.4 ]
noise_minval = [ 1.0, 0.1 ]
n_comp = 3
n_epochs = 100
precision = 0.1
sample_size = 10
seed = 1337

[trainers.immutables.predict]
n_comp = 3
sample_size = 100
seed = 1337
