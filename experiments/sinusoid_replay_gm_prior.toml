[task_sequence]
name = "sinusoid"

[evaluation]
metrics = ["accuracy"]

[plot]
n_classes = 2
x1_max = 3.0
x1_min = -0.5
x2_max = 1.5
x2_min = -1.0

[model]
name = "FCNN3"

[model.args]
dense0 = 16
dense1 = 16
dense2 = 1

[model.spec]
nll = "SIGMOID_CROSS_ENTROPY"
in_shape = [ 2 ]
out_shape = [ 1 ]

[[trainers]]
id = "gmsfsvi1"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=1$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 1
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 1
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi2"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=2$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 2
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 2
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi3"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=3$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 3
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 3
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi4"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=4$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 4
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 4
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi5"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=5$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 5
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 5
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi6"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=6$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 6
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 6
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi7"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=7$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 7
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 7
sample_size = 100
seed = 1337

[[trainers]]
id = "gmsfsvi8"
name = "PriorExactGMSFSVI"
label = "PE GM S-FSVI\n($m=8$)"

[trainers.hparams.train]
base_lr = 0.01
batch_size = 64
coreset_batch_size = 32
coreset_prob = 0.5
coreset_size_per_task = 64
equal_weight = false
lr_schedule = "onecycle"
mc = false
noise_maxval = [ 3.0, 1.5 ]
noise_minval = [ -0.5, -1.0 ]
n_comp = 8
n_epochs = 100
precision = 1.0
sample_size = 10
seed = 1337

[trainers.hparams.predict]
n_comp = 8
sample_size = 100
seed = 1337
