[dataset_sequence]
name = "split_mnist"
pass_batch_size = 128

[dataset_sequence.spec]
validation = false

[model]
module = "models.fcnn"
name = "FCNN3"

[model.spec]
dense0 = 256
dense1 = 256
dense2 = 10

[[trainers]]
id = "joint"
module = "train.replay"
name = "Joint"

[trainers.hyperparams]
basic_loss_fn = "softmax"
draw_batch_size = 128
init_coreset = false
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_epochs = 10
precision = 0.01
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.map"
name = "SoftmaxMAPPredictor"

[[trainers]]
id = "finetuning"
module = "train"
name = "Finetuning"

[trainers.hyperparams]
basic_loss_fn = "softmax"
draw_batch_size = 128
init_coreset = false
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_epochs = 10
precision = 0.01
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.map"
name = "SoftmaxMAPPredictor"

[[trainers]]
id = "replay"
module = "train.replay"
name = "BalancedRandomCoresetReplay"

[trainers.hyperparams]
basic_loss_fn = "softmax"
coreset_selection_key = 1337
coreset_size = 40
draw_batch_size = 128
init_coreset = false
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_epochs = 10
precision = 0.01
sample_key = 1337
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.map"
name = "SoftmaxMAPPredictor"

[[trainers]]
id = "gvcl"
module = "train.svi"
name = "GaussianVCL"

[trainers.hyperparams]
basic_loss_fn = "softmax"
beta = 1.0
draw_batch_size = 128
init_coreset = false
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_epochs = 10
precision = 0.01
sample_size = 100
sample_key = 1337
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.bma"
name = "SoftmaxGVIBMAPredictor"

[trainers.predictor.spec]
sample_key = 1337
sample_size = 100

[[trainers]]
id = "gmvcl"
module = "train.svi"
name = "GaussianMixtureVCL"

[trainers.hyperparams]
basic_loss_fn = "softmax"
beta = 1.0
draw_batch_size = 128
init_coreset = false
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_comp = 3
n_epochs = 10
precision = 0.01
sample_size = 100
sample_key = 1337
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.bma"
name = "SoftmaxGMVIBMAPredictor"

[trainers.predictor.spec]
sample_key = 1337
sample_size = 100

[[trainers]]
id = "gsfsvi"
module = "train.svi"
name = "BalancedRandomCoresetGaussianSFSVI"

[trainers.hyperparams]
basic_loss_fn = "softmax"
beta = 1.0
coreset_selection_key = 1337
coreset_size = 40
draw_batch_size = 128
init_coreset = true
init_coreset_key = 1337
init_coreset_minval = 0.0
init_coreset_maxval = 1.0
init_state_key = 1337
input_shape = [ 1, 28, 28, 1 ]
lr = 0.01
memmap = false
n_epochs = 10
precision = 0.01
sample_size = 100
sample_key = 1337
shuffle_key = 1337

[trainers.predictor]
module = "evaluate.predict.bma"
name = "SoftmaxGVIBMAPredictor"

[trainers.predictor.spec]
sample_key = 1337
sample_size = 100
