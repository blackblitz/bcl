[task_sequence]
name = "split_mnist"

[evaluation]
metrics = ["accuracy"]
validation_metric = "accuracy"

[feature_extractor]
name = "FECNN4"
task_sequence_name = "emnist_letters"

[feature_extractor.evaluation]
metrics = [ "accuracy" ]

[feature_extractor.args]
conv0 = 32
conv1 = 32
dense0 = 32
dense1 = 26
feature_activation = "swish"

[feature_extractor.spec]
nll = "SOFTMAX_CROSS_ENTROPY"
in_shape = [ 28, 28, 1 ]
out_shape = [ 10 ]

[feature_extractor.immutables.train]
batch_size = 32
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[feature_extractor.immutables.predict]

[model]
name = "FCNN1"

[model.args]
dense = 10

[model.spec]
nll = "SOFTMAX_CROSS_ENTROPY"
in_shape = [ 32 ]
out_shape = [ 10 ]

[[trainers]]
id = "joint"
name = "Joint"

[trainers.immutables.train]
batch_size = 32
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "finetuning"
name = "Finetuning"

[trainers.immutables.train]
batch_size = 32
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "ewc1"
name = "ElasticWeightConsolidation"

[trainers.immutables.train]
batch_size = 32
lambda = 0.01
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "ewc2"
name = "ElasticWeightConsolidation"

[trainers.immutables.train]
batch_size = 32
lambda = 1.0
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "ewc3"
name = "ElasticWeightConsolidation"

[trainers.immutables.train]
batch_size = 32
lambda = 100.0
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "si1"
name = "SynapticIntelligence"

[trainers.immutables.train]
batch_size = 32
lambda = 0.01
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337
xi = 1.0

[trainers.immutables.predict]

[[trainers]]
id = "si2"
name = "SynapticIntelligence"

[trainers.immutables.train]
batch_size = 32
lambda = 1.0
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337
xi = 1.0

[trainers.immutables.predict]

[[trainers]]
id = "si3"
name = "SynapticIntelligence"

[trainers.immutables.train]
batch_size = 32
lambda = 100.0
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337
xi = 1.0

[trainers.immutables.predict]

[[trainers]]
id = "aqc"
name = "AutodiffQuadraticConsolidation"

[trainers.immutables.train]
batch_size = 32
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "nc1"
name = "NeuralConsolidation"

[trainers.immutables.train]
batch_size = 32
con_dense0 = 256
con_dense1 = 256
con_lr = 0.001
con_n_steps = 1000
con_precision = 0.1
con_radius = 1.0
con_sample_size = 64
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "nc2"
name = "NeuralConsolidation"

[trainers.immutables.train]
batch_size = 32
con_dense0 = 256
con_dense1 = 256
con_lr = 0.001
con_n_steps = 1000
con_precision = 0.1
con_radius = 10.0
con_sample_size = 64
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]

[[trainers]]
id = "nc3"
name = "NeuralConsolidation"

[trainers.immutables.train]
batch_size = 32
con_dense0 = 256
con_dense1 = 256
con_lr = 0.001
con_n_steps = 1000
con_precision = 0.1
con_radius = 100.0
con_sample_size = 64
lr = 0.001
n_epochs = 10
precision = 0.1
seed = 1337

[trainers.immutables.predict]
